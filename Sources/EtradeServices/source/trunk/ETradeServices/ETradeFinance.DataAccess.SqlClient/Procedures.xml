<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type='text/xsl' href="scriptsql.xsl"?>
<root xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<database includeDrop="true">ETradeFinance</database>
<procedures>
		
		<procedure owner="dbo" name="OddLotOrder_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the OddLotOrder table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ID],
					[SecSymbol],
					[Side],
					[Price],
					[Volume],
					[SubCustAccountID],
					[Market],
					[ExecPrice],
					[ExecVol],
					[CanceledVol],
					[Status],
					[BrokerID],
					[RequestTime],
					[ExecTime],
					[Note]
				FROM
					[dbo].[OddLotOrder]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="OddLotOrder_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the OddLotOrder table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ID]'
				SET @SQL = @SQL + ', [SecSymbol]'
				SET @SQL = @SQL + ', [Side]'
				SET @SQL = @SQL + ', [Price]'
				SET @SQL = @SQL + ', [Volume]'
				SET @SQL = @SQL + ', [SubCustAccountID]'
				SET @SQL = @SQL + ', [Market]'
				SET @SQL = @SQL + ', [ExecPrice]'
				SET @SQL = @SQL + ', [ExecVol]'
				SET @SQL = @SQL + ', [CanceledVol]'
				SET @SQL = @SQL + ', [Status]'
				SET @SQL = @SQL + ', [BrokerID]'
				SET @SQL = @SQL + ', [RequestTime]'
				SET @SQL = @SQL + ', [ExecTime]'
				SET @SQL = @SQL + ', [Note]'
				SET @SQL = @SQL + ' FROM [dbo].[OddLotOrder]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ID],'
				SET @SQL = @SQL + ' [SecSymbol],'
				SET @SQL = @SQL + ' [Side],'
				SET @SQL = @SQL + ' [Price],'
				SET @SQL = @SQL + ' [Volume],'
				SET @SQL = @SQL + ' [SubCustAccountID],'
				SET @SQL = @SQL + ' [Market],'
				SET @SQL = @SQL + ' [ExecPrice],'
				SET @SQL = @SQL + ' [ExecVol],'
				SET @SQL = @SQL + ' [CanceledVol],'
				SET @SQL = @SQL + ' [Status],'
				SET @SQL = @SQL + ' [BrokerID],'
				SET @SQL = @SQL + ' [RequestTime],'
				SET @SQL = @SQL + ' [ExecTime],'
				SET @SQL = @SQL + ' [Note]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[OddLotOrder]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="OddLotOrder_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the OddLotOrder table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Output" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@Side" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@Price" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault=""/>
				<parameter name="@Volume" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubCustAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@Market" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@ExecPrice" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault=""/>
				<parameter name="@ExecVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@CanceledVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[OddLotOrder]
					(
					[SecSymbol]
					,[Side]
					,[Price]
					,[Volume]
					,[SubCustAccountID]
					,[Market]
					,[ExecPrice]
					,[ExecVol]
					,[CanceledVol]
					,[Status]
					,[BrokerID]
					,[RequestTime]
					,[ExecTime]
					,[Note]
					)
				VALUES
					(
					@SecSymbol
					,@Side
					,@Price
					,@Volume
					,@SubCustAccountId
					,@Market
					,@ExecPrice
					,@ExecVol
					,@CanceledVol
					,@Status
					,@BrokerId
					,@RequestTime
					,@ExecTime
					,@Note
					)
				
				-- Get the identity value
				SET @Id = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OddLotOrder_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the OddLotOrder table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@Side" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@Price" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault=""/>
				<parameter name="@Volume" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubCustAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@Market" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@ExecPrice" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault=""/>
				<parameter name="@ExecVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@CanceledVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[OddLotOrder]
				SET
					[SecSymbol] = @SecSymbol
					,[Side] = @Side
					,[Price] = @Price
					,[Volume] = @Volume
					,[SubCustAccountID] = @SubCustAccountId
					,[Market] = @Market
					,[ExecPrice] = @ExecPrice
					,[ExecVol] = @ExecVol
					,[CanceledVol] = @CanceledVol
					,[Status] = @Status
					,[BrokerID] = @BrokerId
					,[RequestTime] = @RequestTime
					,[ExecTime] = @ExecTime
					,[Note] = @Note
				WHERE
[ID] = @Id 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OddLotOrder_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the OddLotOrder table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[OddLotOrder] WITH (ROWLOCK) 
				WHERE
					[ID] = @Id
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OddLotOrder_GetById" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the OddLotOrder table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ID],
					[SecSymbol],
					[Side],
					[Price],
					[Volume],
					[SubCustAccountID],
					[Market],
					[ExecPrice],
					[ExecVol],
					[CanceledVol],
					[Status],
					[BrokerID],
					[RequestTime],
					[ExecTime],
					[Note]
				FROM
					[dbo].[OddLotOrder]
				WHERE
					[ID] = @Id
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="OddLotOrder_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the OddLotOrder table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault="null"/>
				<parameter name="@Side" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault="null"/>
				<parameter name="@Price" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault="null"/>
				<parameter name="@Volume" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@SubCustAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@Market" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault="null"/>
				<parameter name="@ExecPrice" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault="null"/>
				<parameter name="@ExecVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@CanceledVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ID]
	, [SecSymbol]
	, [Side]
	, [Price]
	, [Volume]
	, [SubCustAccountID]
	, [Market]
	, [ExecPrice]
	, [ExecVol]
	, [CanceledVol]
	, [Status]
	, [BrokerID]
	, [RequestTime]
	, [ExecTime]
	, [Note]
    FROM
	[dbo].[OddLotOrder]
    WHERE 
	 ([ID] = @Id OR @Id IS NULL)
	AND ([SecSymbol] = @SecSymbol OR @SecSymbol IS NULL)
	AND ([Side] = @Side OR @Side IS NULL)
	AND ([Price] = @Price OR @Price IS NULL)
	AND ([Volume] = @Volume OR @Volume IS NULL)
	AND ([SubCustAccountID] = @SubCustAccountId OR @SubCustAccountId IS NULL)
	AND ([Market] = @Market OR @Market IS NULL)
	AND ([ExecPrice] = @ExecPrice OR @ExecPrice IS NULL)
	AND ([ExecVol] = @ExecVol OR @ExecVol IS NULL)
	AND ([CanceledVol] = @CanceledVol OR @CanceledVol IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([BrokerID] = @BrokerId OR @BrokerId IS NULL)
	AND ([RequestTime] = @RequestTime OR @RequestTime IS NULL)
	AND ([ExecTime] = @ExecTime OR @ExecTime IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ID]
	, [SecSymbol]
	, [Side]
	, [Price]
	, [Volume]
	, [SubCustAccountID]
	, [Market]
	, [ExecPrice]
	, [ExecVol]
	, [CanceledVol]
	, [Status]
	, [BrokerID]
	, [RequestTime]
	, [ExecTime]
	, [Note]
    FROM
	[dbo].[OddLotOrder]
    WHERE 
	 ([ID] = @Id AND @Id is not null)
	OR ([SecSymbol] = @SecSymbol AND @SecSymbol is not null)
	OR ([Side] = @Side AND @Side is not null)
	OR ([Price] = @Price AND @Price is not null)
	OR ([Volume] = @Volume AND @Volume is not null)
	OR ([SubCustAccountID] = @SubCustAccountId AND @SubCustAccountId is not null)
	OR ([Market] = @Market AND @Market is not null)
	OR ([ExecPrice] = @ExecPrice AND @ExecPrice is not null)
	OR ([ExecVol] = @ExecVol AND @ExecVol is not null)
	OR ([CanceledVol] = @CanceledVol AND @CanceledVol is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([BrokerID] = @BrokerId AND @BrokerId is not null)
	OR ([RequestTime] = @RequestTime AND @RequestTime is not null)
	OR ([ExecTime] = @ExecTime AND @ExecTime is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="OddLotOrder_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the OddLotOrder table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [ID]
					, [SecSymbol]
					, [Side]
					, [Price]
					, [Volume]
					, [SubCustAccountID]
					, [Market]
					, [ExecPrice]
					, [ExecVol]
					, [CanceledVol]
					, [Status]
					, [BrokerID]
					, [RequestTime]
					, [ExecTime]
					, [Note]
					FROM [dbo].[OddLotOrder] {0}
				)
				SELECT
				       [ID],
				       [SecSymbol],
				       [Side],
				       [Price],
				       [Volume],
				       [SubCustAccountID],
				       [Market],
				       [ExecPrice],
				       [ExecVol],
				       [CanceledVol],
				       [Status],
				       [BrokerID],
				       [RequestTime],
				       [ExecTime],
				       [Note]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[OddLotOrder] {0};
				
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="AdvanceTime_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the AdvanceTime table
-- Table Comment: Thoi gian ung truoc
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ID],
					[StartTime],
					[EndTime],
					[AdvanceType]
				FROM
					[dbo].[AdvanceTime]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="AdvanceTime_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the AdvanceTime table passing page index and page count parameters
-- Table Comment: Thoi gian ung truoc
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ID]'
				SET @SQL = @SQL + ', [StartTime]'
				SET @SQL = @SQL + ', [EndTime]'
				SET @SQL = @SQL + ', [AdvanceType]'
				SET @SQL = @SQL + ' FROM [dbo].[AdvanceTime]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ID],'
				SET @SQL = @SQL + ' [StartTime],'
				SET @SQL = @SQL + ' [EndTime],'
				SET @SQL = @SQL + ' [AdvanceType]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdvanceTime]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="AdvanceTime_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the AdvanceTime table
-- Table Comment: Thoi gian ung truoc
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StartTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@EndTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@AdvanceType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[AdvanceTime]
					(
					[StartTime]
					,[EndTime]
					,[AdvanceType]
					)
				VALUES
					(
					@StartTime
					,@EndTime
					,@AdvanceType
					)
				
				-- Get the identity value
				SET @Id = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="AdvanceTime_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the AdvanceTime table
-- Table Comment: Thoi gian ung truoc
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StartTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@EndTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@AdvanceType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdvanceTime]
				SET
					[StartTime] = @StartTime
					,[EndTime] = @EndTime
					,[AdvanceType] = @AdvanceType
				WHERE
[ID] = @Id 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="AdvanceTime_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the AdvanceTime table
-- Table Comment: Thoi gian ung truoc
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[AdvanceTime] WITH (ROWLOCK) 
				WHERE
					[ID] = @Id
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="AdvanceTime_GetById" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the AdvanceTime table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ID],
					[StartTime],
					[EndTime],
					[AdvanceType]
				FROM
					[dbo].[AdvanceTime]
				WHERE
					[ID] = @Id
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="AdvanceTime_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the AdvanceTime table passing nullable parameters
-- Table Comment: Thoi gian ung truoc
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@StartTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@EndTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@AdvanceType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ID]
	, [StartTime]
	, [EndTime]
	, [AdvanceType]
    FROM
	[dbo].[AdvanceTime]
    WHERE 
	 ([ID] = @Id OR @Id IS NULL)
	AND ([StartTime] = @StartTime OR @StartTime IS NULL)
	AND ([EndTime] = @EndTime OR @EndTime IS NULL)
	AND ([AdvanceType] = @AdvanceType OR @AdvanceType IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ID]
	, [StartTime]
	, [EndTime]
	, [AdvanceType]
    FROM
	[dbo].[AdvanceTime]
    WHERE 
	 ([ID] = @Id AND @Id is not null)
	OR ([StartTime] = @StartTime AND @StartTime is not null)
	OR ([EndTime] = @EndTime AND @EndTime is not null)
	OR ([AdvanceType] = @AdvanceType AND @AdvanceType is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="AdvanceTime_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the AdvanceTime table using a dynamically generated query.
-- Table Comment: Thoi gian ung truoc
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [ID]
					, [StartTime]
					, [EndTime]
					, [AdvanceType]
					FROM [dbo].[AdvanceTime] {0}
				)
				SELECT
				       [ID],
				       [StartTime],
				       [EndTime],
				       [AdvanceType]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[AdvanceTime] {0};
				
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Fee_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the Fee table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[FeeID],
					[MinValue],
					[MaxValue],
					[MinFee],
					[FeeRatio],
					[FeeType],
					[VAT]
				FROM
					[dbo].[Fee]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Fee_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the Fee table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[FeeID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [FeeID]'
				SET @SQL = @SQL + ', [MinValue]'
				SET @SQL = @SQL + ', [MaxValue]'
				SET @SQL = @SQL + ', [MinFee]'
				SET @SQL = @SQL + ', [FeeRatio]'
				SET @SQL = @SQL + ', [FeeType]'
				SET @SQL = @SQL + ', [VAT]'
				SET @SQL = @SQL + ' FROM [dbo].[Fee]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [FeeID],'
				SET @SQL = @SQL + ' [MinValue],'
				SET @SQL = @SQL + ' [MaxValue],'
				SET @SQL = @SQL + ' [MinFee],'
				SET @SQL = @SQL + ' [FeeRatio],'
				SET @SQL = @SQL + ' [FeeType],'
				SET @SQL = @SQL + ' [VAT]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Fee]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Fee_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the Fee table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@FeeId" type="bigint" direction="Output" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@MinValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@MaxValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@MinFee" type="decimal" direction="Input" size="9" precision="12" scale="3" param="(12, 3)" nulldefault=""/>
				<parameter name="@FeeRatio" type="decimal" direction="Input" size="5" precision="8" scale="3" param="(8, 3)" nulldefault=""/>
				<parameter name="@FeeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="5" precision="8" scale="3" param="(8, 3)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[Fee]
					(
					[MinValue]
					,[MaxValue]
					,[MinFee]
					,[FeeRatio]
					,[FeeType]
					,[VAT]
					)
				VALUES
					(
					@MinValue
					,@MaxValue
					,@MinFee
					,@FeeRatio
					,@FeeType
					,@Vat
					)
				
				-- Get the identity value
				SET @FeeId = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Fee_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the Fee table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@FeeId" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@MinValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@MaxValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@MinFee" type="decimal" direction="Input" size="9" precision="12" scale="3" param="(12, 3)" nulldefault=""/>
				<parameter name="@FeeRatio" type="decimal" direction="Input" size="5" precision="8" scale="3" param="(8, 3)" nulldefault=""/>
				<parameter name="@FeeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="5" precision="8" scale="3" param="(8, 3)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Fee]
				SET
					[MinValue] = @MinValue
					,[MaxValue] = @MaxValue
					,[MinFee] = @MinFee
					,[FeeRatio] = @FeeRatio
					,[FeeType] = @FeeType
					,[VAT] = @Vat
				WHERE
[FeeID] = @FeeId 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Fee_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the Fee table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@FeeId" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[Fee] WITH (ROWLOCK) 
				WHERE
					[FeeID] = @FeeId
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Fee_GetByFeeId" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the Fee table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@FeeId" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[FeeID],
					[MinValue],
					[MaxValue],
					[MinFee],
					[FeeRatio],
					[FeeType],
					[VAT]
				FROM
					[dbo].[Fee]
				WHERE
					[FeeID] = @FeeId
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Fee_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the Fee table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@FeeId" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@MinValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@MaxValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@MinFee" type="decimal" direction="Input" size="9" precision="12" scale="3" param="(12, 3)" nulldefault="null"/>
				<parameter name="@FeeRatio" type="decimal" direction="Input" size="5" precision="8" scale="3" param="(8, 3)" nulldefault="null"/>
				<parameter name="@FeeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Vat" type="decimal" direction="Input" size="5" precision="8" scale="3" param="(8, 3)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [FeeID]
	, [MinValue]
	, [MaxValue]
	, [MinFee]
	, [FeeRatio]
	, [FeeType]
	, [VAT]
    FROM
	[dbo].[Fee]
    WHERE 
	 ([FeeID] = @FeeId OR @FeeId IS NULL)
	AND ([MinValue] = @MinValue OR @MinValue IS NULL)
	AND ([MaxValue] = @MaxValue OR @MaxValue IS NULL)
	AND ([MinFee] = @MinFee OR @MinFee IS NULL)
	AND ([FeeRatio] = @FeeRatio OR @FeeRatio IS NULL)
	AND ([FeeType] = @FeeType OR @FeeType IS NULL)
	AND ([VAT] = @Vat OR @Vat IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [FeeID]
	, [MinValue]
	, [MaxValue]
	, [MinFee]
	, [FeeRatio]
	, [FeeType]
	, [VAT]
    FROM
	[dbo].[Fee]
    WHERE 
	 ([FeeID] = @FeeId AND @FeeId is not null)
	OR ([MinValue] = @MinValue AND @MinValue is not null)
	OR ([MaxValue] = @MaxValue AND @MaxValue is not null)
	OR ([MinFee] = @MinFee AND @MinFee is not null)
	OR ([FeeRatio] = @FeeRatio AND @FeeRatio is not null)
	OR ([FeeType] = @FeeType AND @FeeType is not null)
	OR ([VAT] = @Vat AND @Vat is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="Fee_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the Fee table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [FeeID]
					, [MinValue]
					, [MaxValue]
					, [MinFee]
					, [FeeRatio]
					, [FeeType]
					, [VAT]
					FROM [dbo].[Fee] {0}
				)
				SELECT
				       [FeeID],
				       [MinValue],
				       [MaxValue],
				       [MinFee],
				       [FeeRatio],
				       [FeeType],
				       [VAT]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[Fee] {0};
				
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="StockTransfer_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the StockTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ID],
					[SecSymbol],
					[WithdrawableAmt],
					[TransferedAmt],
					[AdvOrderAmt],
					[AvilableAmt],
					[RequestAmt],
					[RequestTime],
					[SrcAccountID],
					[DestAccountID],
					[TransType],
					[Status],
					[ExecTime],
					[ApprovedAmt],
					[Note],
					[BrokerID]
				FROM
					[dbo].[StockTransfer]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="StockTransfer_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the StockTransfer table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ID]'
				SET @SQL = @SQL + ', [SecSymbol]'
				SET @SQL = @SQL + ', [WithdrawableAmt]'
				SET @SQL = @SQL + ', [TransferedAmt]'
				SET @SQL = @SQL + ', [AdvOrderAmt]'
				SET @SQL = @SQL + ', [AvilableAmt]'
				SET @SQL = @SQL + ', [RequestAmt]'
				SET @SQL = @SQL + ', [RequestTime]'
				SET @SQL = @SQL + ', [SrcAccountID]'
				SET @SQL = @SQL + ', [DestAccountID]'
				SET @SQL = @SQL + ', [TransType]'
				SET @SQL = @SQL + ', [Status]'
				SET @SQL = @SQL + ', [ExecTime]'
				SET @SQL = @SQL + ', [ApprovedAmt]'
				SET @SQL = @SQL + ', [Note]'
				SET @SQL = @SQL + ', [BrokerID]'
				SET @SQL = @SQL + ' FROM [dbo].[StockTransfer]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ID],'
				SET @SQL = @SQL + ' [SecSymbol],'
				SET @SQL = @SQL + ' [WithdrawableAmt],'
				SET @SQL = @SQL + ' [TransferedAmt],'
				SET @SQL = @SQL + ' [AdvOrderAmt],'
				SET @SQL = @SQL + ' [AvilableAmt],'
				SET @SQL = @SQL + ' [RequestAmt],'
				SET @SQL = @SQL + ' [RequestTime],'
				SET @SQL = @SQL + ' [SrcAccountID],'
				SET @SQL = @SQL + ' [DestAccountID],'
				SET @SQL = @SQL + ' [TransType],'
				SET @SQL = @SQL + ' [Status],'
				SET @SQL = @SQL + ' [ExecTime],'
				SET @SQL = @SQL + ' [ApprovedAmt],'
				SET @SQL = @SQL + ' [Note],'
				SET @SQL = @SQL + ' [BrokerID]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[StockTransfer]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="StockTransfer_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the StockTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Output" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@WithdrawableAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@TransferedAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@AdvOrderAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@AvilableAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SrcAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@DestAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@TransType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ApprovedAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[StockTransfer]
					(
					[SecSymbol]
					,[WithdrawableAmt]
					,[TransferedAmt]
					,[AdvOrderAmt]
					,[AvilableAmt]
					,[RequestAmt]
					,[RequestTime]
					,[SrcAccountID]
					,[DestAccountID]
					,[TransType]
					,[Status]
					,[ExecTime]
					,[ApprovedAmt]
					,[Note]
					,[BrokerID]
					)
				VALUES
					(
					@SecSymbol
					,@WithdrawableAmt
					,@TransferedAmt
					,@AdvOrderAmt
					,@AvilableAmt
					,@RequestAmt
					,@RequestTime
					,@SrcAccountId
					,@DestAccountId
					,@TransType
					,@Status
					,@ExecTime
					,@ApprovedAmt
					,@Note
					,@BrokerId
					)
				
				-- Get the identity value
				SET @Id = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="StockTransfer_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the StockTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@WithdrawableAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@TransferedAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@AdvOrderAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@AvilableAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SrcAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@DestAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@TransType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ApprovedAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[StockTransfer]
				SET
					[SecSymbol] = @SecSymbol
					,[WithdrawableAmt] = @WithdrawableAmt
					,[TransferedAmt] = @TransferedAmt
					,[AdvOrderAmt] = @AdvOrderAmt
					,[AvilableAmt] = @AvilableAmt
					,[RequestAmt] = @RequestAmt
					,[RequestTime] = @RequestTime
					,[SrcAccountID] = @SrcAccountId
					,[DestAccountID] = @DestAccountId
					,[TransType] = @TransType
					,[Status] = @Status
					,[ExecTime] = @ExecTime
					,[ApprovedAmt] = @ApprovedAmt
					,[Note] = @Note
					,[BrokerID] = @BrokerId
				WHERE
[ID] = @Id 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="StockTransfer_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the StockTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[StockTransfer] WITH (ROWLOCK) 
				WHERE
					[ID] = @Id
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="StockTransfer_GetById" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the StockTransfer table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ID],
					[SecSymbol],
					[WithdrawableAmt],
					[TransferedAmt],
					[AdvOrderAmt],
					[AvilableAmt],
					[RequestAmt],
					[RequestTime],
					[SrcAccountID],
					[DestAccountID],
					[TransType],
					[Status],
					[ExecTime],
					[ApprovedAmt],
					[Note],
					[BrokerID]
				FROM
					[dbo].[StockTransfer]
				WHERE
					[ID] = @Id
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="StockTransfer_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the StockTransfer table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault="null"/>
				<parameter name="@WithdrawableAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@TransferedAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@AdvOrderAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@AvilableAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@RequestAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@SrcAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@DestAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@TransType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ApprovedAmt" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ID]
	, [SecSymbol]
	, [WithdrawableAmt]
	, [TransferedAmt]
	, [AdvOrderAmt]
	, [AvilableAmt]
	, [RequestAmt]
	, [RequestTime]
	, [SrcAccountID]
	, [DestAccountID]
	, [TransType]
	, [Status]
	, [ExecTime]
	, [ApprovedAmt]
	, [Note]
	, [BrokerID]
    FROM
	[dbo].[StockTransfer]
    WHERE 
	 ([ID] = @Id OR @Id IS NULL)
	AND ([SecSymbol] = @SecSymbol OR @SecSymbol IS NULL)
	AND ([WithdrawableAmt] = @WithdrawableAmt OR @WithdrawableAmt IS NULL)
	AND ([TransferedAmt] = @TransferedAmt OR @TransferedAmt IS NULL)
	AND ([AdvOrderAmt] = @AdvOrderAmt OR @AdvOrderAmt IS NULL)
	AND ([AvilableAmt] = @AvilableAmt OR @AvilableAmt IS NULL)
	AND ([RequestAmt] = @RequestAmt OR @RequestAmt IS NULL)
	AND ([RequestTime] = @RequestTime OR @RequestTime IS NULL)
	AND ([SrcAccountID] = @SrcAccountId OR @SrcAccountId IS NULL)
	AND ([DestAccountID] = @DestAccountId OR @DestAccountId IS NULL)
	AND ([TransType] = @TransType OR @TransType IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([ExecTime] = @ExecTime OR @ExecTime IS NULL)
	AND ([ApprovedAmt] = @ApprovedAmt OR @ApprovedAmt IS NULL)
	AND ([BrokerID] = @BrokerId OR @BrokerId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ID]
	, [SecSymbol]
	, [WithdrawableAmt]
	, [TransferedAmt]
	, [AdvOrderAmt]
	, [AvilableAmt]
	, [RequestAmt]
	, [RequestTime]
	, [SrcAccountID]
	, [DestAccountID]
	, [TransType]
	, [Status]
	, [ExecTime]
	, [ApprovedAmt]
	, [Note]
	, [BrokerID]
    FROM
	[dbo].[StockTransfer]
    WHERE 
	 ([ID] = @Id AND @Id is not null)
	OR ([SecSymbol] = @SecSymbol AND @SecSymbol is not null)
	OR ([WithdrawableAmt] = @WithdrawableAmt AND @WithdrawableAmt is not null)
	OR ([TransferedAmt] = @TransferedAmt AND @TransferedAmt is not null)
	OR ([AdvOrderAmt] = @AdvOrderAmt AND @AdvOrderAmt is not null)
	OR ([AvilableAmt] = @AvilableAmt AND @AvilableAmt is not null)
	OR ([RequestAmt] = @RequestAmt AND @RequestAmt is not null)
	OR ([RequestTime] = @RequestTime AND @RequestTime is not null)
	OR ([SrcAccountID] = @SrcAccountId AND @SrcAccountId is not null)
	OR ([DestAccountID] = @DestAccountId AND @DestAccountId is not null)
	OR ([TransType] = @TransType AND @TransType is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([ExecTime] = @ExecTime AND @ExecTime is not null)
	OR ([ApprovedAmt] = @ApprovedAmt AND @ApprovedAmt is not null)
	OR ([BrokerID] = @BrokerId AND @BrokerId is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="StockTransfer_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the StockTransfer table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [ID]
					, [SecSymbol]
					, [WithdrawableAmt]
					, [TransferedAmt]
					, [AdvOrderAmt]
					, [AvilableAmt]
					, [RequestAmt]
					, [RequestTime]
					, [SrcAccountID]
					, [DestAccountID]
					, [TransType]
					, [Status]
					, [ExecTime]
					, [ApprovedAmt]
					, [Note]
					, [BrokerID]
					FROM [dbo].[StockTransfer] {0}
				)
				SELECT
				       [ID],
				       [SecSymbol],
				       [WithdrawableAmt],
				       [TransferedAmt],
				       [AdvOrderAmt],
				       [AvilableAmt],
				       [RequestAmt],
				       [RequestTime],
				       [SrcAccountID],
				       [DestAccountID],
				       [TransType],
				       [Status],
				       [ExecTime],
				       [ApprovedAmt],
				       [Note],
				       [BrokerID]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[StockTransfer] {0};
				
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="CashAdvance_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the CashAdvance table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ID],
					[SubAccountID],
					[AdvanceDate],
					[ContractNo],
					[OrderID],
					[StockSymbol],
					[SellDueDate],
					[CashDueDate],
					[TotalSellValue],
					[CashAvailable],
					[CashRequest],
					[Fee],
					[CashReceived],
					[Status],
					[TradeType],
					[BrokerID],
					[Reason],
					[ExecTime],
					[VAT]
				FROM
					[dbo].[CashAdvance]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="CashAdvance_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the CashAdvance table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ID]'
				SET @SQL = @SQL + ', [SubAccountID]'
				SET @SQL = @SQL + ', [AdvanceDate]'
				SET @SQL = @SQL + ', [ContractNo]'
				SET @SQL = @SQL + ', [OrderID]'
				SET @SQL = @SQL + ', [StockSymbol]'
				SET @SQL = @SQL + ', [SellDueDate]'
				SET @SQL = @SQL + ', [CashDueDate]'
				SET @SQL = @SQL + ', [TotalSellValue]'
				SET @SQL = @SQL + ', [CashAvailable]'
				SET @SQL = @SQL + ', [CashRequest]'
				SET @SQL = @SQL + ', [Fee]'
				SET @SQL = @SQL + ', [CashReceived]'
				SET @SQL = @SQL + ', [Status]'
				SET @SQL = @SQL + ', [TradeType]'
				SET @SQL = @SQL + ', [BrokerID]'
				SET @SQL = @SQL + ', [Reason]'
				SET @SQL = @SQL + ', [ExecTime]'
				SET @SQL = @SQL + ', [VAT]'
				SET @SQL = @SQL + ' FROM [dbo].[CashAdvance]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ID],'
				SET @SQL = @SQL + ' [SubAccountID],'
				SET @SQL = @SQL + ' [AdvanceDate],'
				SET @SQL = @SQL + ' [ContractNo],'
				SET @SQL = @SQL + ' [OrderID],'
				SET @SQL = @SQL + ' [StockSymbol],'
				SET @SQL = @SQL + ' [SellDueDate],'
				SET @SQL = @SQL + ' [CashDueDate],'
				SET @SQL = @SQL + ' [TotalSellValue],'
				SET @SQL = @SQL + ' [CashAvailable],'
				SET @SQL = @SQL + ' [CashRequest],'
				SET @SQL = @SQL + ' [Fee],'
				SET @SQL = @SQL + ' [CashReceived],'
				SET @SQL = @SQL + ' [Status],'
				SET @SQL = @SQL + ' [TradeType],'
				SET @SQL = @SQL + ' [BrokerID],'
				SET @SQL = @SQL + ' [Reason],'
				SET @SQL = @SQL + ' [ExecTime],'
				SET @SQL = @SQL + ' [VAT]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[CashAdvance]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="CashAdvance_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the CashAdvance table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Output" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@AdvanceDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ContractNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StockSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@SellDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CashDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalSellValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashAvailable" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashRequest" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashReceived" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@TradeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@Reason" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[CashAdvance]
					(
					[SubAccountID]
					,[AdvanceDate]
					,[ContractNo]
					,[OrderID]
					,[StockSymbol]
					,[SellDueDate]
					,[CashDueDate]
					,[TotalSellValue]
					,[CashAvailable]
					,[CashRequest]
					,[Fee]
					,[CashReceived]
					,[Status]
					,[TradeType]
					,[BrokerID]
					,[Reason]
					,[ExecTime]
					,[VAT]
					)
				VALUES
					(
					@SubAccountId
					,@AdvanceDate
					,@ContractNo
					,@OrderId
					,@StockSymbol
					,@SellDueDate
					,@CashDueDate
					,@TotalSellValue
					,@CashAvailable
					,@CashRequest
					,@Fee
					,@CashReceived
					,@Status
					,@TradeType
					,@BrokerId
					,@Reason
					,@ExecTime
					,@Vat
					)
				
				-- Get the identity value
				SET @Id = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashAdvance_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the CashAdvance table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@AdvanceDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ContractNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StockSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@SellDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CashDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalSellValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashAvailable" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashRequest" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashReceived" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@TradeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@Reason" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[CashAdvance]
				SET
					[SubAccountID] = @SubAccountId
					,[AdvanceDate] = @AdvanceDate
					,[ContractNo] = @ContractNo
					,[OrderID] = @OrderId
					,[StockSymbol] = @StockSymbol
					,[SellDueDate] = @SellDueDate
					,[CashDueDate] = @CashDueDate
					,[TotalSellValue] = @TotalSellValue
					,[CashAvailable] = @CashAvailable
					,[CashRequest] = @CashRequest
					,[Fee] = @Fee
					,[CashReceived] = @CashReceived
					,[Status] = @Status
					,[TradeType] = @TradeType
					,[BrokerID] = @BrokerId
					,[Reason] = @Reason
					,[ExecTime] = @ExecTime
					,[VAT] = @Vat
				WHERE
[ID] = @Id 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashAdvance_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the CashAdvance table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[CashAdvance] WITH (ROWLOCK) 
				WHERE
					[ID] = @Id
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashAdvance_GetById" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the CashAdvance table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ID],
					[SubAccountID],
					[AdvanceDate],
					[ContractNo],
					[OrderID],
					[StockSymbol],
					[SellDueDate],
					[CashDueDate],
					[TotalSellValue],
					[CashAvailable],
					[CashRequest],
					[Fee],
					[CashReceived],
					[Status],
					[TradeType],
					[BrokerID],
					[Reason],
					[ExecTime],
					[VAT]
				FROM
					[dbo].[CashAdvance]
				WHERE
					[ID] = @Id
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="CashAdvance_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the CashAdvance table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@AdvanceDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ContractNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@StockSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault="null"/>
				<parameter name="@SellDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@CashDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@TotalSellValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@CashAvailable" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@CashRequest" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@CashReceived" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@TradeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@Reason" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ID]
	, [SubAccountID]
	, [AdvanceDate]
	, [ContractNo]
	, [OrderID]
	, [StockSymbol]
	, [SellDueDate]
	, [CashDueDate]
	, [TotalSellValue]
	, [CashAvailable]
	, [CashRequest]
	, [Fee]
	, [CashReceived]
	, [Status]
	, [TradeType]
	, [BrokerID]
	, [Reason]
	, [ExecTime]
	, [VAT]
    FROM
	[dbo].[CashAdvance]
    WHERE 
	 ([ID] = @Id OR @Id IS NULL)
	AND ([SubAccountID] = @SubAccountId OR @SubAccountId IS NULL)
	AND ([AdvanceDate] = @AdvanceDate OR @AdvanceDate IS NULL)
	AND ([ContractNo] = @ContractNo OR @ContractNo IS NULL)
	AND ([OrderID] = @OrderId OR @OrderId IS NULL)
	AND ([StockSymbol] = @StockSymbol OR @StockSymbol IS NULL)
	AND ([SellDueDate] = @SellDueDate OR @SellDueDate IS NULL)
	AND ([CashDueDate] = @CashDueDate OR @CashDueDate IS NULL)
	AND ([TotalSellValue] = @TotalSellValue OR @TotalSellValue IS NULL)
	AND ([CashAvailable] = @CashAvailable OR @CashAvailable IS NULL)
	AND ([CashRequest] = @CashRequest OR @CashRequest IS NULL)
	AND ([Fee] = @Fee OR @Fee IS NULL)
	AND ([CashReceived] = @CashReceived OR @CashReceived IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([TradeType] = @TradeType OR @TradeType IS NULL)
	AND ([BrokerID] = @BrokerId OR @BrokerId IS NULL)
	AND ([ExecTime] = @ExecTime OR @ExecTime IS NULL)
	AND ([VAT] = @Vat OR @Vat IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ID]
	, [SubAccountID]
	, [AdvanceDate]
	, [ContractNo]
	, [OrderID]
	, [StockSymbol]
	, [SellDueDate]
	, [CashDueDate]
	, [TotalSellValue]
	, [CashAvailable]
	, [CashRequest]
	, [Fee]
	, [CashReceived]
	, [Status]
	, [TradeType]
	, [BrokerID]
	, [Reason]
	, [ExecTime]
	, [VAT]
    FROM
	[dbo].[CashAdvance]
    WHERE 
	 ([ID] = @Id AND @Id is not null)
	OR ([SubAccountID] = @SubAccountId AND @SubAccountId is not null)
	OR ([AdvanceDate] = @AdvanceDate AND @AdvanceDate is not null)
	OR ([ContractNo] = @ContractNo AND @ContractNo is not null)
	OR ([OrderID] = @OrderId AND @OrderId is not null)
	OR ([StockSymbol] = @StockSymbol AND @StockSymbol is not null)
	OR ([SellDueDate] = @SellDueDate AND @SellDueDate is not null)
	OR ([CashDueDate] = @CashDueDate AND @CashDueDate is not null)
	OR ([TotalSellValue] = @TotalSellValue AND @TotalSellValue is not null)
	OR ([CashAvailable] = @CashAvailable AND @CashAvailable is not null)
	OR ([CashRequest] = @CashRequest AND @CashRequest is not null)
	OR ([Fee] = @Fee AND @Fee is not null)
	OR ([CashReceived] = @CashReceived AND @CashReceived is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([TradeType] = @TradeType AND @TradeType is not null)
	OR ([BrokerID] = @BrokerId AND @BrokerId is not null)
	OR ([ExecTime] = @ExecTime AND @ExecTime is not null)
	OR ([VAT] = @Vat AND @Vat is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="CashAdvance_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the CashAdvance table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [ID]
					, [SubAccountID]
					, [AdvanceDate]
					, [ContractNo]
					, [OrderID]
					, [StockSymbol]
					, [SellDueDate]
					, [CashDueDate]
					, [TotalSellValue]
					, [CashAvailable]
					, [CashRequest]
					, [Fee]
					, [CashReceived]
					, [Status]
					, [TradeType]
					, [BrokerID]
					, [Reason]
					, [ExecTime]
					, [VAT]
					FROM [dbo].[CashAdvance] {0}
				)
				SELECT
				       [ID],
				       [SubAccountID],
				       [AdvanceDate],
				       [ContractNo],
				       [OrderID],
				       [StockSymbol],
				       [SellDueDate],
				       [CashDueDate],
				       [TotalSellValue],
				       [CashAvailable],
				       [CashRequest],
				       [Fee],
				       [CashReceived],
				       [Status],
				       [TradeType],
				       [BrokerID],
				       [Reason],
				       [ExecTime],
				       [VAT]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[CashAdvance] {0};
				
				END
			]]></body>
		</procedure>
		
				
		<procedure owner="dbo" name="_CashAdvance_DeleteOldData"  skip="true">
			<comment><![CDATA[
/*
----------------------------------------------------------------------------------------------------
-- Date Created: Wednesday, November 17, 2010

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the ExecOrder table
----------------------------------------------------------------------------------------------------
*/


]]></comment>
			<parameters>
			</parameters>
			<body><![CDATA[
				



				DELETE FROM [dbo].[CashAdvance] WITH (ROWLOCK) 
				WHERE
					[AdvanceDate] < CONVERT(DATETIME, FLOOR(CONVERT(FLOAT, GETDATE())))
					
			


			]]></body>
					</procedure>
		
		<procedure owner="dbo" name="CashTransfer_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the CashTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ID],
					[WithdrawableAmt],
					[TransferedAmt],
					[AdvOrderAmt],
					[AvilableAmt],
					[RequestAmt],
					[RequestTime],
					[Fee],
					[VAT],
					[AmtAfterFee],
					[SrcAccountID],
					[DestAccountID],
					[TransType],
					[Status],
					[ExecTime],
					[ApprovedAmt],
					[Note],
					[BrokerID],
					[BankName],
					[BranchName]
				FROM
					[dbo].[CashTransfer]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="CashTransfer_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the CashTransfer table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ID]'
				SET @SQL = @SQL + ', [WithdrawableAmt]'
				SET @SQL = @SQL + ', [TransferedAmt]'
				SET @SQL = @SQL + ', [AdvOrderAmt]'
				SET @SQL = @SQL + ', [AvilableAmt]'
				SET @SQL = @SQL + ', [RequestAmt]'
				SET @SQL = @SQL + ', [RequestTime]'
				SET @SQL = @SQL + ', [Fee]'
				SET @SQL = @SQL + ', [VAT]'
				SET @SQL = @SQL + ', [AmtAfterFee]'
				SET @SQL = @SQL + ', [SrcAccountID]'
				SET @SQL = @SQL + ', [DestAccountID]'
				SET @SQL = @SQL + ', [TransType]'
				SET @SQL = @SQL + ', [Status]'
				SET @SQL = @SQL + ', [ExecTime]'
				SET @SQL = @SQL + ', [ApprovedAmt]'
				SET @SQL = @SQL + ', [Note]'
				SET @SQL = @SQL + ', [BrokerID]'
				SET @SQL = @SQL + ', [BankName]'
				SET @SQL = @SQL + ', [BranchName]'
				SET @SQL = @SQL + ' FROM [dbo].[CashTransfer]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ID],'
				SET @SQL = @SQL + ' [WithdrawableAmt],'
				SET @SQL = @SQL + ' [TransferedAmt],'
				SET @SQL = @SQL + ' [AdvOrderAmt],'
				SET @SQL = @SQL + ' [AvilableAmt],'
				SET @SQL = @SQL + ' [RequestAmt],'
				SET @SQL = @SQL + ' [RequestTime],'
				SET @SQL = @SQL + ' [Fee],'
				SET @SQL = @SQL + ' [VAT],'
				SET @SQL = @SQL + ' [AmtAfterFee],'
				SET @SQL = @SQL + ' [SrcAccountID],'
				SET @SQL = @SQL + ' [DestAccountID],'
				SET @SQL = @SQL + ' [TransType],'
				SET @SQL = @SQL + ' [Status],'
				SET @SQL = @SQL + ' [ExecTime],'
				SET @SQL = @SQL + ' [ApprovedAmt],'
				SET @SQL = @SQL + ' [Note],'
				SET @SQL = @SQL + ' [BrokerID],'
				SET @SQL = @SQL + ' [BankName],'
				SET @SQL = @SQL + ' [BranchName]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[CashTransfer]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="CashTransfer_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the CashTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Output" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@WithdrawableAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@TransferedAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@AdvOrderAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@AvilableAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@RequestAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@AmtAfterFee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@SrcAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@DestAccountId" type="varchar" direction="Input" size="64" precision="0" scale="0" param="(64)" nulldefault=""/>
				<parameter name="@TransType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ApprovedAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BankName" type="nvarchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@BranchName" type="nvarchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[CashTransfer]
					(
					[WithdrawableAmt]
					,[TransferedAmt]
					,[AdvOrderAmt]
					,[AvilableAmt]
					,[RequestAmt]
					,[RequestTime]
					,[Fee]
					,[VAT]
					,[AmtAfterFee]
					,[SrcAccountID]
					,[DestAccountID]
					,[TransType]
					,[Status]
					,[ExecTime]
					,[ApprovedAmt]
					,[Note]
					,[BrokerID]
					,[BankName]
					,[BranchName]
					)
				VALUES
					(
					@WithdrawableAmt
					,@TransferedAmt
					,@AdvOrderAmt
					,@AvilableAmt
					,@RequestAmt
					,@RequestTime
					,@Fee
					,@Vat
					,@AmtAfterFee
					,@SrcAccountId
					,@DestAccountId
					,@TransType
					,@Status
					,@ExecTime
					,@ApprovedAmt
					,@Note
					,@BrokerId
					,@BankName
					,@BranchName
					)
				
				-- Get the identity value
				SET @Id = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashTransfer_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the CashTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@WithdrawableAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@TransferedAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@AdvOrderAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@AvilableAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@RequestAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@AmtAfterFee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@SrcAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@DestAccountId" type="varchar" direction="Input" size="64" precision="0" scale="0" param="(64)" nulldefault=""/>
				<parameter name="@TransType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ApprovedAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BankName" type="nvarchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@BranchName" type="nvarchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[CashTransfer]
				SET
					[WithdrawableAmt] = @WithdrawableAmt
					,[TransferedAmt] = @TransferedAmt
					,[AdvOrderAmt] = @AdvOrderAmt
					,[AvilableAmt] = @AvilableAmt
					,[RequestAmt] = @RequestAmt
					,[RequestTime] = @RequestTime
					,[Fee] = @Fee
					,[VAT] = @Vat
					,[AmtAfterFee] = @AmtAfterFee
					,[SrcAccountID] = @SrcAccountId
					,[DestAccountID] = @DestAccountId
					,[TransType] = @TransType
					,[Status] = @Status
					,[ExecTime] = @ExecTime
					,[ApprovedAmt] = @ApprovedAmt
					,[Note] = @Note
					,[BrokerID] = @BrokerId
					,[BankName] = @BankName
					,[BranchName] = @BranchName
				WHERE
[ID] = @Id 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashTransfer_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the CashTransfer table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[CashTransfer] WITH (ROWLOCK) 
				WHERE
					[ID] = @Id
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashTransfer_GetById" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the CashTransfer table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ID],
					[WithdrawableAmt],
					[TransferedAmt],
					[AdvOrderAmt],
					[AvilableAmt],
					[RequestAmt],
					[RequestTime],
					[Fee],
					[VAT],
					[AmtAfterFee],
					[SrcAccountID],
					[DestAccountID],
					[TransType],
					[Status],
					[ExecTime],
					[ApprovedAmt],
					[Note],
					[BrokerID],
					[BankName],
					[BranchName]
				FROM
					[dbo].[CashTransfer]
				WHERE
					[ID] = @Id
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="CashTransfer_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the CashTransfer table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@WithdrawableAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@TransferedAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@AdvOrderAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@AvilableAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@RequestAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@AmtAfterFee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@SrcAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@DestAccountId" type="varchar" direction="Input" size="64" precision="0" scale="0" param="(64)" nulldefault="null"/>
				<parameter name="@TransType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ApprovedAmt" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@BankName" type="nvarchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
				<parameter name="@BranchName" type="nvarchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ID]
	, [WithdrawableAmt]
	, [TransferedAmt]
	, [AdvOrderAmt]
	, [AvilableAmt]
	, [RequestAmt]
	, [RequestTime]
	, [Fee]
	, [VAT]
	, [AmtAfterFee]
	, [SrcAccountID]
	, [DestAccountID]
	, [TransType]
	, [Status]
	, [ExecTime]
	, [ApprovedAmt]
	, [Note]
	, [BrokerID]
	, [BankName]
	, [BranchName]
    FROM
	[dbo].[CashTransfer]
    WHERE 
	 ([ID] = @Id OR @Id IS NULL)
	AND ([WithdrawableAmt] = @WithdrawableAmt OR @WithdrawableAmt IS NULL)
	AND ([TransferedAmt] = @TransferedAmt OR @TransferedAmt IS NULL)
	AND ([AdvOrderAmt] = @AdvOrderAmt OR @AdvOrderAmt IS NULL)
	AND ([AvilableAmt] = @AvilableAmt OR @AvilableAmt IS NULL)
	AND ([RequestAmt] = @RequestAmt OR @RequestAmt IS NULL)
	AND ([RequestTime] = @RequestTime OR @RequestTime IS NULL)
	AND ([Fee] = @Fee OR @Fee IS NULL)
	AND ([VAT] = @Vat OR @Vat IS NULL)
	AND ([AmtAfterFee] = @AmtAfterFee OR @AmtAfterFee IS NULL)
	AND ([SrcAccountID] = @SrcAccountId OR @SrcAccountId IS NULL)
	AND ([DestAccountID] = @DestAccountId OR @DestAccountId IS NULL)
	AND ([TransType] = @TransType OR @TransType IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([ExecTime] = @ExecTime OR @ExecTime IS NULL)
	AND ([ApprovedAmt] = @ApprovedAmt OR @ApprovedAmt IS NULL)
	AND ([BrokerID] = @BrokerId OR @BrokerId IS NULL)
	AND ([BankName] = @BankName OR @BankName IS NULL)
	AND ([BranchName] = @BranchName OR @BranchName IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ID]
	, [WithdrawableAmt]
	, [TransferedAmt]
	, [AdvOrderAmt]
	, [AvilableAmt]
	, [RequestAmt]
	, [RequestTime]
	, [Fee]
	, [VAT]
	, [AmtAfterFee]
	, [SrcAccountID]
	, [DestAccountID]
	, [TransType]
	, [Status]
	, [ExecTime]
	, [ApprovedAmt]
	, [Note]
	, [BrokerID]
	, [BankName]
	, [BranchName]
    FROM
	[dbo].[CashTransfer]
    WHERE 
	 ([ID] = @Id AND @Id is not null)
	OR ([WithdrawableAmt] = @WithdrawableAmt AND @WithdrawableAmt is not null)
	OR ([TransferedAmt] = @TransferedAmt AND @TransferedAmt is not null)
	OR ([AdvOrderAmt] = @AdvOrderAmt AND @AdvOrderAmt is not null)
	OR ([AvilableAmt] = @AvilableAmt AND @AvilableAmt is not null)
	OR ([RequestAmt] = @RequestAmt AND @RequestAmt is not null)
	OR ([RequestTime] = @RequestTime AND @RequestTime is not null)
	OR ([Fee] = @Fee AND @Fee is not null)
	OR ([VAT] = @Vat AND @Vat is not null)
	OR ([AmtAfterFee] = @AmtAfterFee AND @AmtAfterFee is not null)
	OR ([SrcAccountID] = @SrcAccountId AND @SrcAccountId is not null)
	OR ([DestAccountID] = @DestAccountId AND @DestAccountId is not null)
	OR ([TransType] = @TransType AND @TransType is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([ExecTime] = @ExecTime AND @ExecTime is not null)
	OR ([ApprovedAmt] = @ApprovedAmt AND @ApprovedAmt is not null)
	OR ([BrokerID] = @BrokerId AND @BrokerId is not null)
	OR ([BankName] = @BankName AND @BankName is not null)
	OR ([BranchName] = @BranchName AND @BranchName is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="CashTransfer_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the CashTransfer table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [ID]
					, [WithdrawableAmt]
					, [TransferedAmt]
					, [AdvOrderAmt]
					, [AvilableAmt]
					, [RequestAmt]
					, [RequestTime]
					, [Fee]
					, [VAT]
					, [AmtAfterFee]
					, [SrcAccountID]
					, [DestAccountID]
					, [TransType]
					, [Status]
					, [ExecTime]
					, [ApprovedAmt]
					, [Note]
					, [BrokerID]
					, [BankName]
					, [BranchName]
					FROM [dbo].[CashTransfer] {0}
				)
				SELECT
				       [ID],
				       [WithdrawableAmt],
				       [TransferedAmt],
				       [AdvOrderAmt],
				       [AvilableAmt],
				       [RequestAmt],
				       [RequestTime],
				       [Fee],
				       [VAT],
				       [AmtAfterFee],
				       [SrcAccountID],
				       [DestAccountID],
				       [TransType],
				       [Status],
				       [ExecTime],
				       [ApprovedAmt],
				       [Note],
				       [BrokerID],
				       [BankName],
				       [BranchName]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[CashTransfer] {0};
				
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="XROrders_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the XROrders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ID],
					[SubAccountID],
					[BuyRightID],
					[SecSymbol],
					[Market],
					[Volume],
					[Price],
					[RegisteredVol],
					[AvailableVol],
					[RequestVol],
					[RequestTime],
					[ApprovedVol],
					[Status],
					[BrokerID],
					[ExecTime],
					[Note]
				FROM
					[dbo].[XROrders]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="XROrders_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the XROrders table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ID]'
				SET @SQL = @SQL + ', [SubAccountID]'
				SET @SQL = @SQL + ', [BuyRightID]'
				SET @SQL = @SQL + ', [SecSymbol]'
				SET @SQL = @SQL + ', [Market]'
				SET @SQL = @SQL + ', [Volume]'
				SET @SQL = @SQL + ', [Price]'
				SET @SQL = @SQL + ', [RegisteredVol]'
				SET @SQL = @SQL + ', [AvailableVol]'
				SET @SQL = @SQL + ', [RequestVol]'
				SET @SQL = @SQL + ', [RequestTime]'
				SET @SQL = @SQL + ', [ApprovedVol]'
				SET @SQL = @SQL + ', [Status]'
				SET @SQL = @SQL + ', [BrokerID]'
				SET @SQL = @SQL + ', [ExecTime]'
				SET @SQL = @SQL + ', [Note]'
				SET @SQL = @SQL + ' FROM [dbo].[XROrders]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ID],'
				SET @SQL = @SQL + ' [SubAccountID],'
				SET @SQL = @SQL + ' [BuyRightID],'
				SET @SQL = @SQL + ' [SecSymbol],'
				SET @SQL = @SQL + ' [Market],'
				SET @SQL = @SQL + ' [Volume],'
				SET @SQL = @SQL + ' [Price],'
				SET @SQL = @SQL + ' [RegisteredVol],'
				SET @SQL = @SQL + ' [AvailableVol],'
				SET @SQL = @SQL + ' [RequestVol],'
				SET @SQL = @SQL + ' [RequestTime],'
				SET @SQL = @SQL + ' [ApprovedVol],'
				SET @SQL = @SQL + ' [Status],'
				SET @SQL = @SQL + ' [BrokerID],'
				SET @SQL = @SQL + ' [ExecTime],'
				SET @SQL = @SQL + ' [Note]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[XROrders]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="XROrders_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the XROrders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Output" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BuyRightId" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@Market" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@Volume" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Price" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault=""/>
				<parameter name="@RegisteredVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@AvailableVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ApprovedVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[XROrders]
					(
					[SubAccountID]
					,[BuyRightID]
					,[SecSymbol]
					,[Market]
					,[Volume]
					,[Price]
					,[RegisteredVol]
					,[AvailableVol]
					,[RequestVol]
					,[RequestTime]
					,[ApprovedVol]
					,[Status]
					,[BrokerID]
					,[ExecTime]
					,[Note]
					)
				VALUES
					(
					@SubAccountId
					,@BuyRightId
					,@SecSymbol
					,@Market
					,@Volume
					,@Price
					,@RegisteredVol
					,@AvailableVol
					,@RequestVol
					,@RequestTime
					,@ApprovedVol
					,@Status
					,@BrokerId
					,@ExecTime
					,@Note
					)
				
				-- Get the identity value
				SET @Id = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="XROrders_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the XROrders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BuyRightId" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@Market" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@Volume" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Price" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault=""/>
				<parameter name="@RegisteredVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@AvailableVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ApprovedVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[XROrders]
				SET
					[SubAccountID] = @SubAccountId
					,[BuyRightID] = @BuyRightId
					,[SecSymbol] = @SecSymbol
					,[Market] = @Market
					,[Volume] = @Volume
					,[Price] = @Price
					,[RegisteredVol] = @RegisteredVol
					,[AvailableVol] = @AvailableVol
					,[RequestVol] = @RequestVol
					,[RequestTime] = @RequestTime
					,[ApprovedVol] = @ApprovedVol
					,[Status] = @Status
					,[BrokerID] = @BrokerId
					,[ExecTime] = @ExecTime
					,[Note] = @Note
				WHERE
[ID] = @Id 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="XROrders_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the XROrders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[XROrders] WITH (ROWLOCK) 
				WHERE
					[ID] = @Id
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="XROrders_GetById" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the XROrders table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ID],
					[SubAccountID],
					[BuyRightID],
					[SecSymbol],
					[Market],
					[Volume],
					[Price],
					[RegisteredVol],
					[AvailableVol],
					[RequestVol],
					[RequestTime],
					[ApprovedVol],
					[Status],
					[BrokerID],
					[ExecTime],
					[Note]
				FROM
					[dbo].[XROrders]
				WHERE
					[ID] = @Id
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="XROrders_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the XROrders table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@BuyRightId" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@SecSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault="null"/>
				<parameter name="@Market" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault="null"/>
				<parameter name="@Volume" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@Price" type="decimal" direction="Input" size="9" precision="10" scale="3" param="(10, 3)" nulldefault="null"/>
				<parameter name="@RegisteredVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@AvailableVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@RequestVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@RequestTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ApprovedVol" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Note" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ID]
	, [SubAccountID]
	, [BuyRightID]
	, [SecSymbol]
	, [Market]
	, [Volume]
	, [Price]
	, [RegisteredVol]
	, [AvailableVol]
	, [RequestVol]
	, [RequestTime]
	, [ApprovedVol]
	, [Status]
	, [BrokerID]
	, [ExecTime]
	, [Note]
    FROM
	[dbo].[XROrders]
    WHERE 
	 ([ID] = @Id OR @Id IS NULL)
	AND ([SubAccountID] = @SubAccountId OR @SubAccountId IS NULL)
	AND ([BuyRightID] = @BuyRightId OR @BuyRightId IS NULL)
	AND ([SecSymbol] = @SecSymbol OR @SecSymbol IS NULL)
	AND ([Market] = @Market OR @Market IS NULL)
	AND ([Volume] = @Volume OR @Volume IS NULL)
	AND ([Price] = @Price OR @Price IS NULL)
	AND ([RegisteredVol] = @RegisteredVol OR @RegisteredVol IS NULL)
	AND ([AvailableVol] = @AvailableVol OR @AvailableVol IS NULL)
	AND ([RequestVol] = @RequestVol OR @RequestVol IS NULL)
	AND ([RequestTime] = @RequestTime OR @RequestTime IS NULL)
	AND ([ApprovedVol] = @ApprovedVol OR @ApprovedVol IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([BrokerID] = @BrokerId OR @BrokerId IS NULL)
	AND ([ExecTime] = @ExecTime OR @ExecTime IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ID]
	, [SubAccountID]
	, [BuyRightID]
	, [SecSymbol]
	, [Market]
	, [Volume]
	, [Price]
	, [RegisteredVol]
	, [AvailableVol]
	, [RequestVol]
	, [RequestTime]
	, [ApprovedVol]
	, [Status]
	, [BrokerID]
	, [ExecTime]
	, [Note]
    FROM
	[dbo].[XROrders]
    WHERE 
	 ([ID] = @Id AND @Id is not null)
	OR ([SubAccountID] = @SubAccountId AND @SubAccountId is not null)
	OR ([BuyRightID] = @BuyRightId AND @BuyRightId is not null)
	OR ([SecSymbol] = @SecSymbol AND @SecSymbol is not null)
	OR ([Market] = @Market AND @Market is not null)
	OR ([Volume] = @Volume AND @Volume is not null)
	OR ([Price] = @Price AND @Price is not null)
	OR ([RegisteredVol] = @RegisteredVol AND @RegisteredVol is not null)
	OR ([AvailableVol] = @AvailableVol AND @AvailableVol is not null)
	OR ([RequestVol] = @RequestVol AND @RequestVol is not null)
	OR ([RequestTime] = @RequestTime AND @RequestTime is not null)
	OR ([ApprovedVol] = @ApprovedVol AND @ApprovedVol is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([BrokerID] = @BrokerId AND @BrokerId is not null)
	OR ([ExecTime] = @ExecTime AND @ExecTime is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="XROrders_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the XROrders table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [ID]
					, [SubAccountID]
					, [BuyRightID]
					, [SecSymbol]
					, [Market]
					, [Volume]
					, [Price]
					, [RegisteredVol]
					, [AvailableVol]
					, [RequestVol]
					, [RequestTime]
					, [ApprovedVol]
					, [Status]
					, [BrokerID]
					, [ExecTime]
					, [Note]
					FROM [dbo].[XROrders] {0}
				)
				SELECT
				       [ID],
				       [SubAccountID],
				       [BuyRightID],
				       [SecSymbol],
				       [Market],
				       [Volume],
				       [Price],
				       [RegisteredVol],
				       [AvailableVol],
				       [RequestVol],
				       [RequestTime],
				       [ApprovedVol],
				       [Status],
				       [BrokerID],
				       [ExecTime],
				       [Note]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[XROrders] {0};
				
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="CashAdvanceHistory_Get_List" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets all records from the CashAdvanceHistory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ID],
					[SubAccountID],
					[AdvanceDate],
					[ContractNo],
					[OrderID],
					[StockSymbol],
					[SellDueDate],
					[CashDueDate],
					[TotalSellValue],
					[CashAvilable],
					[CashRequest],
					[Fee],
					[CashReceived],
					[Status],
					[TradeType],
					[BrokerID],
					[BrokerName],
					[Reason],
					[ExecTime],
					[VAT]
				FROM
					[dbo].[CashAdvanceHistory]
					
				SELECT @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="CashAdvanceHistory_GetPaged" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the CashAdvanceHistory table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy IS NULL OR LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ID]'
				END

				-- SQL Server 2005 Paging
				DECLARE @SQL AS nvarchar(MAX)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ID]'
				SET @SQL = @SQL + ', [SubAccountID]'
				SET @SQL = @SQL + ', [AdvanceDate]'
				SET @SQL = @SQL + ', [ContractNo]'
				SET @SQL = @SQL + ', [OrderID]'
				SET @SQL = @SQL + ', [StockSymbol]'
				SET @SQL = @SQL + ', [SellDueDate]'
				SET @SQL = @SQL + ', [CashDueDate]'
				SET @SQL = @SQL + ', [TotalSellValue]'
				SET @SQL = @SQL + ', [CashAvilable]'
				SET @SQL = @SQL + ', [CashRequest]'
				SET @SQL = @SQL + ', [Fee]'
				SET @SQL = @SQL + ', [CashReceived]'
				SET @SQL = @SQL + ', [Status]'
				SET @SQL = @SQL + ', [TradeType]'
				SET @SQL = @SQL + ', [BrokerID]'
				SET @SQL = @SQL + ', [BrokerName]'
				SET @SQL = @SQL + ', [Reason]'
				SET @SQL = @SQL + ', [ExecTime]'
				SET @SQL = @SQL + ', [VAT]'
				SET @SQL = @SQL + ' FROM [dbo].[CashAdvanceHistory]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ID],'
				SET @SQL = @SQL + ' [SubAccountID],'
				SET @SQL = @SQL + ' [AdvanceDate],'
				SET @SQL = @SQL + ' [ContractNo],'
				SET @SQL = @SQL + ' [OrderID],'
				SET @SQL = @SQL + ' [StockSymbol],'
				SET @SQL = @SQL + ' [SellDueDate],'
				SET @SQL = @SQL + ' [CashDueDate],'
				SET @SQL = @SQL + ' [TotalSellValue],'
				SET @SQL = @SQL + ' [CashAvilable],'
				SET @SQL = @SQL + ' [CashRequest],'
				SET @SQL = @SQL + ' [Fee],'
				SET @SQL = @SQL + ' [CashReceived],'
				SET @SQL = @SQL + ' [Status],'
				SET @SQL = @SQL + ' [TradeType],'
				SET @SQL = @SQL + ' [BrokerID],'
				SET @SQL = @SQL + ' [BrokerName],'
				SET @SQL = @SQL + ' [Reason],'
				SET @SQL = @SQL + ' [ExecTime],'
				SET @SQL = @SQL + ' [VAT]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + CONVERT(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				EXEC sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[CashAdvanceHistory]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="CashAdvanceHistory_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Inserts a record into the CashAdvanceHistory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Output" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@AdvanceDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ContractNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StockSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@SellDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CashDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalSellValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashAvilable" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashRequest" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashReceived" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@TradeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BrokerName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Reason" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				INSERT INTO [dbo].[CashAdvanceHistory]
					(
					[SubAccountID]
					,[AdvanceDate]
					,[ContractNo]
					,[OrderID]
					,[StockSymbol]
					,[SellDueDate]
					,[CashDueDate]
					,[TotalSellValue]
					,[CashAvilable]
					,[CashRequest]
					,[Fee]
					,[CashReceived]
					,[Status]
					,[TradeType]
					,[BrokerID]
					,[BrokerName]
					,[Reason]
					,[ExecTime]
					,[VAT]
					)
				VALUES
					(
					@SubAccountId
					,@AdvanceDate
					,@ContractNo
					,@OrderId
					,@StockSymbol
					,@SellDueDate
					,@CashDueDate
					,@TotalSellValue
					,@CashAvilable
					,@CashRequest
					,@Fee
					,@CashReceived
					,@Status
					,@TradeType
					,@BrokerId
					,@BrokerName
					,@Reason
					,@ExecTime
					,@Vat
					)
				
				-- Get the identity value
				SET @Id = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashAdvanceHistory_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Updates a record in the CashAdvanceHistory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@AdvanceDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ContractNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StockSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault=""/>
				<parameter name="@SellDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CashDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalSellValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashAvilable" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashRequest" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@CashReceived" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@TradeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BrokerName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Reason" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[CashAdvanceHistory]
				SET
					[SubAccountID] = @SubAccountId
					,[AdvanceDate] = @AdvanceDate
					,[ContractNo] = @ContractNo
					,[OrderID] = @OrderId
					,[StockSymbol] = @StockSymbol
					,[SellDueDate] = @SellDueDate
					,[CashDueDate] = @CashDueDate
					,[TotalSellValue] = @TotalSellValue
					,[CashAvilable] = @CashAvilable
					,[CashRequest] = @CashRequest
					,[Fee] = @Fee
					,[CashReceived] = @CashReceived
					,[Status] = @Status
					,[TradeType] = @TradeType
					,[BrokerID] = @BrokerId
					,[BrokerName] = @BrokerName
					,[Reason] = @Reason
					,[ExecTime] = @ExecTime
					,[VAT] = @Vat
				WHERE
[ID] = @Id 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashAdvanceHistory_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Deletes a record in the CashAdvanceHistory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM [dbo].[CashAdvanceHistory] WITH (ROWLOCK) 
				WHERE
					[ID] = @Id
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CashAdvanceHistory_GetById" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Select records from the CashAdvanceHistory table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ID],
					[SubAccountID],
					[AdvanceDate],
					[ContractNo],
					[OrderID],
					[StockSymbol],
					[SellDueDate],
					[CashDueDate],
					[TotalSellValue],
					[CashAvilable],
					[CashRequest],
					[Fee],
					[CashReceived],
					[Status],
					[TradeType],
					[BrokerID],
					[BrokerName],
					[Reason],
					[ExecTime],
					[VAT]
				FROM
					[dbo].[CashAdvanceHistory]
				WHERE
					[ID] = @Id
				SELECT @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="CashAdvanceHistory_Find" >
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Finds records in the CashAdvanceHistory table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="bigint" direction="Input" size="8" precision="19" scale="0" param="" nulldefault="null"/>
				<parameter name="@SubAccountId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@AdvanceDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ContractNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@StockSymbol" type="varchar" direction="Input" size="8" precision="0" scale="0" param="(8)" nulldefault="null"/>
				<parameter name="@SellDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@CashDueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@TotalSellValue" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@CashAvilable" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@CashRequest" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@Fee" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@CashReceived" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@TradeType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@BrokerId" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@BrokerName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Reason" type="ntext" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@ExecTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Vat" type="decimal" direction="Input" size="9" precision="18" scale="3" param="(18, 3)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ID]
	, [SubAccountID]
	, [AdvanceDate]
	, [ContractNo]
	, [OrderID]
	, [StockSymbol]
	, [SellDueDate]
	, [CashDueDate]
	, [TotalSellValue]
	, [CashAvilable]
	, [CashRequest]
	, [Fee]
	, [CashReceived]
	, [Status]
	, [TradeType]
	, [BrokerID]
	, [BrokerName]
	, [Reason]
	, [ExecTime]
	, [VAT]
    FROM
	[dbo].[CashAdvanceHistory]
    WHERE 
	 ([ID] = @Id OR @Id IS NULL)
	AND ([SubAccountID] = @SubAccountId OR @SubAccountId IS NULL)
	AND ([AdvanceDate] = @AdvanceDate OR @AdvanceDate IS NULL)
	AND ([ContractNo] = @ContractNo OR @ContractNo IS NULL)
	AND ([OrderID] = @OrderId OR @OrderId IS NULL)
	AND ([StockSymbol] = @StockSymbol OR @StockSymbol IS NULL)
	AND ([SellDueDate] = @SellDueDate OR @SellDueDate IS NULL)
	AND ([CashDueDate] = @CashDueDate OR @CashDueDate IS NULL)
	AND ([TotalSellValue] = @TotalSellValue OR @TotalSellValue IS NULL)
	AND ([CashAvilable] = @CashAvilable OR @CashAvilable IS NULL)
	AND ([CashRequest] = @CashRequest OR @CashRequest IS NULL)
	AND ([Fee] = @Fee OR @Fee IS NULL)
	AND ([CashReceived] = @CashReceived OR @CashReceived IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([TradeType] = @TradeType OR @TradeType IS NULL)
	AND ([BrokerID] = @BrokerId OR @BrokerId IS NULL)
	AND ([BrokerName] = @BrokerName OR @BrokerName IS NULL)
	AND ([ExecTime] = @ExecTime OR @ExecTime IS NULL)
	AND ([VAT] = @Vat OR @Vat IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ID]
	, [SubAccountID]
	, [AdvanceDate]
	, [ContractNo]
	, [OrderID]
	, [StockSymbol]
	, [SellDueDate]
	, [CashDueDate]
	, [TotalSellValue]
	, [CashAvilable]
	, [CashRequest]
	, [Fee]
	, [CashReceived]
	, [Status]
	, [TradeType]
	, [BrokerID]
	, [BrokerName]
	, [Reason]
	, [ExecTime]
	, [VAT]
    FROM
	[dbo].[CashAdvanceHistory]
    WHERE 
	 ([ID] = @Id AND @Id is not null)
	OR ([SubAccountID] = @SubAccountId AND @SubAccountId is not null)
	OR ([AdvanceDate] = @AdvanceDate AND @AdvanceDate is not null)
	OR ([ContractNo] = @ContractNo AND @ContractNo is not null)
	OR ([OrderID] = @OrderId AND @OrderId is not null)
	OR ([StockSymbol] = @StockSymbol AND @StockSymbol is not null)
	OR ([SellDueDate] = @SellDueDate AND @SellDueDate is not null)
	OR ([CashDueDate] = @CashDueDate AND @CashDueDate is not null)
	OR ([TotalSellValue] = @TotalSellValue AND @TotalSellValue is not null)
	OR ([CashAvilable] = @CashAvilable AND @CashAvilable is not null)
	OR ([CashRequest] = @CashRequest AND @CashRequest is not null)
	OR ([Fee] = @Fee AND @Fee is not null)
	OR ([CashReceived] = @CashReceived AND @CashReceived is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([TradeType] = @TradeType AND @TradeType is not null)
	OR ([BrokerID] = @BrokerId AND @BrokerId is not null)
	OR ([BrokerName] = @BrokerName AND @BrokerName is not null)
	OR ([ExecTime] = @ExecTime AND @ExecTime is not null)
	OR ([VAT] = @Vat AND @Vat is not null)
	SELECT @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="CashAdvanceHistory_Find_Dynamic"  skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Thursday, May 05, 2011

-- Created By: OTS Co., Ltd. (http://ots.vn)
-- Purpose: Gets records from the CashAdvanceHistory table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				WITH PageIndex AS (
					SELECT TOP {3} row_number() over (order by {1}) AS RowIndex
					, [ID]
					, [SubAccountID]
					, [AdvanceDate]
					, [ContractNo]
					, [OrderID]
					, [StockSymbol]
					, [SellDueDate]
					, [CashDueDate]
					, [TotalSellValue]
					, [CashAvilable]
					, [CashRequest]
					, [Fee]
					, [CashReceived]
					, [Status]
					, [TradeType]
					, [BrokerID]
					, [BrokerName]
					, [Reason]
					, [ExecTime]
					, [VAT]
					FROM [dbo].[CashAdvanceHistory] {0}
				)
				SELECT
				       [ID],
				       [SubAccountID],
				       [AdvanceDate],
				       [ContractNo],
				       [OrderID],
				       [StockSymbol],
				       [SellDueDate],
				       [CashDueDate],
				       [TotalSellValue],
				       [CashAvilable],
				       [CashRequest],
				       [Fee],
				       [CashReceived],
				       [Status],
				       [TradeType],
				       [BrokerID],
				       [BrokerName],
				       [Reason],
				       [ExecTime],
				       [VAT]
				  FROM PageIndex
				 WHERE RowIndex > {2}
				   AND RowIndex <= {3}
				ORDER BY {1};
				

				-- get total count
				SELECT COUNT(*) AS TotalRowCount FROM [dbo].[CashAdvanceHistory] {0};
				
				END
			]]></body>
		</procedure>
		
</procedures>
</root>
